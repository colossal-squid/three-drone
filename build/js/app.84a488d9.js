(()=>{"use strict";var e,t={893:(e,t,n)=>{var o=n(480);const a=100;let i;const s=[],r={isPlayerOnTheGround:!1};function d(e,t,n,o,[a,r,d],l=1){const c=i.add({size:e,pos:t,move:o,name:n,density:l});return c.setRotation({x:a,y:r,z:d}),s.push(c),c}var l=n(212),c=n(365),h=n(688);const p=new(n.n(h)());var u=n(11),w=n(23);const y=new class{constructor(){this.armed=!1,this.throttle=-1,this.yaw=0,this.pitch=0,this.roll=0,p.on("throttleUp",(()=>{let e=this.throttle+.08;this.throttle=Math.min(1,e)})),p.on("throttleDown",(()=>{let e=this.throttle-.08;this.throttle=Math.max(e,-1)})),p.on("yawLeft",(()=>{const e=this.yaw-.1;this.yaw=Math.max(-1,e)})),p.on("yawRight",(()=>{const e=this.yaw+.1;this.yaw=Math.min(1,e)})),p.on("yawCenter",(()=>{this.yaw=0})),p.on("forward",(()=>{let e=this.roll+.24;this.roll=Math.min(1,e)})),p.on("back",(()=>{let e=this.roll-.24;this.roll=Math.max(-1,e)})),p.on("left",(()=>{let e=this.pitch-.24;this.pitch=Math.max(-1,e)})),p.on("right",(()=>{let e=this.pitch+.24;this.pitch=Math.min(1,e)})),p.on("arm",(()=>{this.armed=!this.armed})),window.addEventListener("gamepadconnected",(e=>{console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",e.gamepad.index,e.gamepad.id,e.gamepad.buttons.length,e.gamepad.axes.length)})),window.addEventListener("gamepaddisconnected",(e=>{console.log("Gamepad disconnected from index %d: %s",e.gamepad.index,e.gamepad.id)}))}get name(){return((navigator.getGamepads()||[{}])[0]?.id||"Keyboard controls").substring(0,18)+"..."}update(){const e=(navigator.getGamepads()||[])[0];e&&(this.throttle=e.axes[1],this.yaw=e.axes[0],this.roll=-e.axes[3],this.pitch=e.axes[2])}},m=(new l.dpR).load("public/water.png"),g=(new l.dpR).load("public/ground.jpeg"),b=.017453292519943295,f="fpv",v="third",x="static",k=new l.RSm,P=k,R=new l.vBJ({map:g}),M=new l.vBJ({map:m});let F,O,K,C,T=[],S=v,D=[];function A(){S===f?S=v:S===v?S=x:S===x&&(S=f),console.log("cameraMode:",S)}const j={x:0,y:0,z:0};class E{constructor(e){this.body=e,this.upforce=j,document.addEventListener("keyup",(e=>{switch(e.code){case"KeyA":case"KeyD":p.emit("yawCenter")}})),document.addEventListener("keydown",(e=>{switch(e.code){case"Space":p.emit("arm");break;case"KeyA":p.emit("yawRight");break;case"KeyW":p.emit("throttleUp");break;case"KeyS":p.emit("throttleDown");break;case"KeyD":p.emit("yawLeft");break;case"KeyJ":p.emit("left");break;case"KeyI":p.emit("forward");break;case"KeyK":p.emit("back");break;case"KeyL":p.emit("right");break;case"KeyC":p.emit("cameraToggle");break;case"KeyW":window.location.reload()}})),this.debug=document.querySelector("#debug")}getPosition(){return this.body.getPosition()}getQuaternion(){return this.body.getQuaternion()}moveUpAndDown(){const e=new o.AO(0,2.352*Math.exp(y.throttle),0);e.applyQuaternion(this.body.getQuaternion()),this.body.linearVelocity.y=-2.352+e.y}rotate(){this.body.angularVelocity.y=2*y.yaw}moveForward(){const e=new o.AO(0,0,.02*-y.roll);e.applyQuaternion(this.body.getQuaternion()),this.body.applyImpulse(this.body.getPosition(),e)}moveSideways(){const e=new o.AO(.02*y.pitch,0,0);e.applyQuaternion(this.body.getQuaternion()),this.body.applyImpulse(this.body.getPosition(),e)}update(){let e=[this.body.linearVelocity,this.body.angularVelocity].map((({x:e,y:t,z:n})=>`x:${e.toFixed(2)} y:${t.toFixed(2)} z: ${n.toFixed(2)}`)).join("\n");e+="\nmass: "+(1e3*this.body.mass).toFixed(2)+"g\n",e+="\ngp: "+y.name+"\n",e+="\nWASD - left stick\nIJKL - right stick\nSPACE - arm\nC - change camera mode\nR - reset\nRoman made this! visit\n\nhttps://roman-guivan.online",this.debug.innerHTML=`<pre>${e}</pre>`,y.armed&&(this.moveUpAndDown(),r.isPlayerOnTheGround||(this.rotate(),this.moveForward(),this.moveSideways()))}}var L=n(979);let Q;function z(e,t,n,o=!1,a=[0,0,0]){const i=d(e,t,n,o,a);return function(e,t,n,o=[0,0,0]){let a=new l.DvJ(...e),i=k;switch(n){case"player":i=P;break;case"ground":i=R;break;case"water":i=M}const s=new l.Kj0(a,i);s.position.set(t[0],t[1],t[2]),s.rotation.set(o[0]*b,o[1]*b,o[2]*b),O.add(s),T.push(s)}(e,t,n,a),i}!async function(){i=new o.q3({timestep:1/60,iterations:8,broadphase:2,worldscale:1,random:!0,info:!0,gravity:[0,-9.8,0]}),function(){F=new l.cPb(80,window.innerWidth/window.innerHeight,.01,1e4),F.position.set(-.3,3,1.5),F.rotation.set(1,-.1,-.2),window.camera=F,O=new l.xsS,K=new l.CP7({antialias:!0}),K.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(K.domElement),C=new c.z(F,K.domElement);const e=new l.Mig(4210752);O.add(e),function(){const e=(new l.dpR).load("public/skybox/xpos.png"),t=(new l.dpR).load("public/skybox/xneg.png"),n=(new l.dpR).load("public/skybox/zneg.png"),o=[(new l.dpR).load("public/skybox/zpos.png"),n,(new l.dpR).load("public/skybox/ypos.png"),(new l.dpR).load("public/skybox/yneg.png"),t,e].map((e=>new l.vBJ({map:e,side:l._Li}))),i=new l.DvJ(a,a,a),s=new l.Kj0(i,o);O.add(s)}(),p.on("cameraToggle",A)}(),function(){const e=[2,1,2];z(e,[-2,0,0],"ground"),z(e,[2,0,0],"ground"),z([a,.05,a],[0,-.2,0],"water")}(),await async function(){const e=[.2,.1,.2],t=[-2,4,0],n=d(e,t,"player",!0,[0,0,0],60);n.allowSleep=!1,async function(e,t,n){const o=await function(){const e="public/";return new Promise((t=>{const n=new l.lLk;new w.v(n).setPath(e).load("drone.mtl",(o=>{o.preload(),new u.L(n).setMaterials(o).setPath(e).load("drone.obj",(function(e){e.children.filter((e=>e.name.includes("Prope"))).forEach(((t,n)=>{t.material=P,t.geometry.center();const o=new l.Tme;e.add(o),t.removeFromParent(),t.scale.set(2,2,2),o.add(t),o.position.set(...[[2,0,2],[-2,0,-2],[-2,0,2],[2,0,-2]][n]),t.position.set(0,0,0),D.push(t)})),t(e)}))}))}))}();o.scale.set(...e.map((e=>e/10))),o.position.set(t[0],t[1],t[2]),o.rotation.set(n[0]*b,n[1]*b,n[2]*b),O.add(o),T.push(o)}(e,t,[0,0,0]),Q=new E(n)}(),function(){const e=new L.MxU({width:300,height:100});document.querySelector(".overlay").appendChild(e.view);const t=new L.TCu;e.stage.addChild(t);const n=new L.xvT("-",{fill:16777215});n.position.set(100,0),e.stage.addChild(n);const o=new L.xvT("-",{fill:16777215});o.position.set(100,20),e.stage.addChild(o);const a=new L.xvT("-",{fill:16777215});a.position.set(100,40),e.stage.addChild(a);const i=new L.xvT("DISARMED",{fill:16777215});i.position.set(100,60),e.stage.addChild(i),e.ticker.add((()=>{t.clear(),t.beginFill(65280,.3),t.drawRect(0,0,100,100),t.endFill(),t.beginFill(65280,.3),t.drawRect(200,0,100,100),t.endFill(),t.beginFill(16711680,1),t.drawRect(45+50*-y.yaw,45+50*-y.throttle,10,10),t.endFill(),t.beginFill(16711680,1),t.drawRect(245+50*y.pitch,45+50*-y.roll,10,10),t.endFill(),n.text="T"+100*(2.352*Math.exp(y.throttle)).toFixed(2),o.text="Y"+(2*y.yaw*100).toFixed(2),a.text=r.isPlayerOnTheGround?"GRND":"SKY",i.text=y.armed?"ARMED":"DISRM"}))}(),function e(){requestAnimationFrame(e),y.update(),Q.update(),i.step(),r.isPlayerOnTheGround=!!i.checkContact("player","ground"),function(e,t){!function(e){let t=e.length;for(;t--;){const n=e[t],o=T[t];!n.sleeping&&o&&(o.position.copy(n.getPosition()),o.quaternion.copy(n.getQuaternion()))}}(e),S===f||S===v?function(e){const{x:t,y:n,z:o}=e.getPosition(),a=new l.Pa4(t,n,o);if(S===v){const t=new l.Pa4(0,.15,.35);t.applyQuaternion(e.getQuaternion()),a.add(t)}F.position.copy(a),F.quaternion.copy(e.getQuaternion()),F.updateProjectionMatrix()}(t):C.update(),y.armed&&D.forEach((e=>{e.rotateOnAxis(e.up,(y.throttle+1)/2*.7)})),K.render(O,F)}(s,Q)}()}()}},n={};function o(e){var a=n[e];if(void 0!==a)return a.exports;var i=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.m=t,e=[],o.O=(t,n,a,i)=>{if(!n){var s=1/0;for(c=0;c<e.length;c++){for(var[n,a,i]=e[c],r=!0,d=0;d<n.length;d++)(!1&i||s>=i)&&Object.keys(o.O).every((e=>o.O[e](n[d])))?n.splice(d--,1):(r=!1,i<s&&(s=i));if(r){e.splice(c--,1);var l=a();void 0!==l&&(t=l)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[n,a,i]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={143:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var a,i,[s,r,d]=n,l=0;for(a in r)o.o(r,a)&&(o.m[a]=r[a]);if(d)var c=d(o);for(t&&t(n);l<s.length;l++)i=s[l],o.o(e,i)&&e[i]&&e[i][0](),e[s[l]]=0;return o.O(c)},n=self.webpackChunkwebpack_starter=self.webpackChunkwebpack_starter||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=o.O(void 0,[290],(()=>o(893)));a=o.O(a)})();
//# sourceMappingURL=app.84a488d9.js.map